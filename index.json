[{"categories":["记录"],"content":"欢迎使用新版BookPad! :) ;) 请先预览本页! 感谢您选择BookPad!如果您发现任何问题,欢迎到应用商店中给我们提出您宝贵的意见,我们会尽快修复! 本页是您在BookPad1中的第一个Markdown文档。如果您是第一次使用,本页将会对您十分有用,因为在这里您会看到BookPad的使用方法。 :fa-glass: ","date":"2022-03-02","objectID":"/bookpadhelp/:0:0","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-cog spin: 用法 新版的BookPad中我们舍弃了为您管理一个集中的Markdown文档目录的功能,因为对多数人来说自己管理自己的文档是一件并不困难的事情,而前一个版本的集中管理反而约束了用户的灵活性。 注: BookPad会自动保存您的文档不管您之前是否已经保存过,但是为了您的数据的安全,我们还是建议您定期手动保存:fa-save:。 卸载BookPad将会删除BookPad中您所有未保存的文档! 请确保在卸载前您的文档已经保存。但是……为什么不留着BookPad呢?它会派上用场的! :fa-thumbs-o-up: :fa-smile-o: :fa-thumbs-o-up: :fa-sun-o: :fa-hand-rock-o: :fa-hand-peace-o: 新版的BookPad在性能上有了很大的改善,所以默认状态下就开启了所有高级语法功能。==但依然需要注意==,在启用实时预览的情况下,性能将会有所下降(特别是当您的文档中有mermaid图表的时候)。非常抱歉!之后的版本中我们会继续改进。 新版本中我们做了大量的优化,但肯定还有很多的问题,或是新引入的bug,所以有任何问题您都可以在Store中反馈,我们尽量排好优先级尽快解决。感谢您的支持! :pray: ","date":"2022-03-02","objectID":"/bookpadhelp/:1:0","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":el-menu: 主菜单 新版的BookPad中我们对主菜单按钮做了些调整,它现在不会一直占用您的编辑区域(感谢老用户的建议! :fa-handshake-o: ),但会在编辑器的左下角露出一小部分,当您的鼠标靠近它的时候,它会弹出,此时您可以点击并打开主菜单。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:1","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-files-o: 多文档支持 新版的Bookpad中我们添加了一项非常重要的功能,就是可以同时打开和编辑多个文档。同样需要感谢老用户的建议!有了这个功能,您不必再在多个文档之间来回切换。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:2","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-file: 创建新文档 您可以通过 新建 菜单或是Ctrl + N快捷键来创建新的文档,只不过这种方式创建的文档将会被保存在临时区域,您可以通过保存功能把它保存在任何您期望的位置。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:3","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-refresh: 打开文档 您可以通过 打开 菜单或是Ctrl + O快捷键来打开新的文档。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:4","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-share: 导出PDF(新) 您可以通过在菜单中选择 导出 或是Ctrl + E快捷键来导出。 但此功能尚有些缺陷和限制,如: 引用块不能跨页 着色强调文本不能跨行 Mermaid图表不能导出(会被自动隐藏) 某些样式下可能存在冲突 等等 更重要的是,此功能允许您导出当前打开的一个文档,同时也允许您导出一个目录中指定数目的Markdown文档,并且您可以自定义它们被导出的顺序(勾选顺序就是导出顺序),所有的文档都会被自动合并到一个pdf文档中。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:5","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-globe: 预览文档 您可以通过 预览 菜单或快捷键Ctrl + P来预览当前文档。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:6","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-gears: 设置(新) 在新版本中,我们取消了设置页面,原因是您可以通过快捷键完成所有相应的功能。同时也取消了上传自定义css文件的功能(将来的版本中会添加)。 ","date":"2022-03-02","objectID":"/bookpadhelp/:1:7","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":":fa-bolt: 快捷键 下面列出了BookPad支持的所有快捷键: 应用操作 新建文档: Ctrl + N 打开文档: Ctrl + O 保存文档: Ctrl + S 切换预览: Ctrl + P 切换实时预览: Ctrl + Shift + P 专注模式: Ctrl + Shift + Enter 导出PDF: Ctrl + E 帮助: F1 刷新: F5 编辑器前一个样式: Ctrl + Up 编辑器后一个样式: Ctrl + Down 编辑器默认样式: Ctrl + Enter 预览前一个样式: Alt + Up 预览后一个样式: Alt + Down 预览默认样式: Alt + Enter 预览代码前一个样式: Shift + Alt + Up 预览代码后一个样式: Shift + Alt + Down 预览代码默认样式: Shift + Alt + Enter 预览图表前一个样式: Ctrl + Alt + Up 预览图表后一个样式: Ctrl + Alt + Down 预览图表默认样式: Ctrl + Alt + Enter 编辑器相关 全选: Ctrl+ A 删除当前行: Ctrl + D 搜索: Ctrl + F 搜索下一个: Ctrl + G 搜索上一个: Ctrl + Shift + G 持续搜索: Alt + F 替换: Ctrl + Shift + F 全部替换: Ctrl + Shift + R 跳到行: Alt + G 撤销选中: Ctrl + U 重新选中: Alt + U 重做: Ctrl + Y 撤销: Ctrl + Z 向后缩进前前行: Ctrl + ] 向前缩进当前行: Ctrl + [ 跳到文档开头: Ctrl + Home 跳到文档结尾: Ctrl + End 跳过前一个词: Ctrl + Left 跳过后一个词: Ctrl + Right 跳到本行开头: Alt + Left 跳到本行结尾: Alt + Right 删除前一个词: Ctrl + Backspace 删除后一个词: Ctr + Delete 向后缩进: Tab 向前缩进: Shift + Tab 切换显示行号: Ctrl + Shift + L 切换显示工具栏: Ctrl + Shift + T 增大编辑器字体: Ctrl + + 缩小编辑器字体: Ctrl + - 编辑器工具栏和Markdown语法 粗体: Ctrl-B 斜体: Ctrl-I 表格: Ctrl-T 标题: Ctrl-H 饮用: Ctrl-' 链接: Ctrl-L 下标: Ctr-, 上标: Ctr-. 水平线: Ctrl-R 下划线: Ctrl-Alt-U 代码: Ctrl-Alt-' 图片: Ctrl-Alt-L 脚注: Ctrl-Alt-N 图标: Ctrl-Alt-: ","date":"2022-03-02","objectID":"/bookpadhelp/:1:8","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":"Markdown语法 您可以在这里找到更多关于Markdown语法的内容。 ","date":"2022-03-02","objectID":"/bookpadhelp/:2:0","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":"基本语法 标题 这是一号标题H1 ","date":"2022-03-02","objectID":"/bookpadhelp/:2:1","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":"这是二号标题H2 ","date":"2022-03-02","objectID":"/bookpadhelp/:3:0","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":"这是三号标题H3 这是四号标题H4 这是五号标题H5 这是六号标题H6 这不是标题而是正文内容 强调 斜体 = 两边分别加一个 * 或 _; 粗体 = 两边分别加两个 * 或 _; 粗体加斜体 = 两边分别加三个 * 或 _; 删除线 = 两边分别加两个 ~; 上标 = 两边分别加一个 ~; 下标 = 两边分别加一个 ^; 下划线 = 两边分别加两个以上 +; 着色 = 两边分别加两个以上 =; 定义缩写 = *[缩写]; 下面是一个列子: 一个星号斜体 一个下划线斜体 两个星号粗体 两个下划线粗体 三个星号粗体加斜体 三个下划线粗体加斜体 删除我 M~x~ X^3^ ++你好吗?++ 请 ==不要== 卸载 BookPad *[HTML]: 超文本链接标示语言 BookPad可以以 HTML 来预览格式化结果,在预览模式下你可以把鼠标放在 HTML 上来看它的定义。 引用 这是一个包含两个段落的引用。 在每个段落里都有多行内容。 这是一个包含两个段落的引用。 在每个段落里都有多行内容。 列表 可以在行的最前面放一个 *, + 或 -来表示无序列表: 红色 绿色 蓝色 深蓝色 浅蓝色 等同于: 红色 绿色 蓝色 也等同于: 红色 绿色 蓝色 有序列表用数字加一个点号来表示: 第一项 第二项 子项 2.1 第三项(虽然前面写的是8) 子项 3.1 水平线 你可以通过将三个或更多的短横线、星号或下划线放在单独的一行来产生一个水平线。如果你愿意,你可以它们之间加入空格。下面的每一行都会产生一个相同水平线: 链接 我常用的搜索引擎有: 谷歌, 必应 和 百度. 我常用的搜索引擎有: 谷歌, 必应 和 百度. 我常用的搜索引擎有: 谷歌, 必应 和 百度. 我常用的搜索引擎有: 谷歌, 必应 和 百度. 我常用的搜索引擎有: http://www.google.com, http://www.bing.com 和 http://www.baidu.com. 然后你可以定义下面的链接,并把它们放在文档中任何你希望的地方。它们不会直接显示出来,而是只会被上面的链接所使用。 反斜杠 Markdown里面可以使用反斜杠转意下面的字符(因为它们有特别的含义,所以当你希望看到它们本身的时候需要转意): \\ 反斜杠 ` 反引号 * 星号 _ 下划线 {} 大括号 [] 中括号 () 小括号 # 井号 + 加号 - 减号 . 点号 ! 惊叹号 内嵌HTML 对于任何没有被Markdown语法与重新定义的HTML内容你都可以在Makdown文档中直接使。你不需要加特别的标记来告诉解析器你是在使用Markdown还是在使用HTML。你需要的只是HTML标签本身。 唯一需要注意的是那些像\u003cdiv\u003e, \u003ctable\u003e, \u003cpre\u003e, \u003cp\u003e等的块标签需要在前后加上一个空行,并且开头和结束标签本身前面没有空格或tab键。Markdown不会再自动在这些块标签前后加上多余的\u003cp\u003e。 例如你可以直接在Markdown文档中使用下面的HTML来画一张表: 一些内容 一些内容 一些内容 一些内容 一些内容 一些内容 一些内容 一些内容 一些内容 ","date":"2022-03-02","objectID":"/bookpadhelp/:3:1","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":"Markdown扩展语法 术语定义列表 术语 1 术语 2 这是第一种定义 A 这里是第二种定义 B 术语 3 这里是第一种定义 C 这里是第二种定义 D 表格 配件 价格 主板 5000¥ 键盘 200¥ 显示器 2000¥ 你可以用半角冒号来使用列对齐: 配件 价格 数量 主板 5000¥ 80 键盘 200¥ 200 显示器 2000¥ 100 代码高亮 /* HelloWorld.java */ public class HelloWorld { public static void main(String[] args) { System.out.println(\"Hello World!\"); } } #!/usr/bin/python # Say hello, world. print \"Hello, world!\" \u003c!DOCTYPE html\u003e \u003ctitle\u003eTitle\u003c/title\u003e \u003cstyle\u003ebody {width: 500px;}\u003c/style\u003e \u003cscript type=\"application/javascript\"\u003e function $init() {return true;} \u003c/script\u003e \u003cbody\u003e \u003cp checked class=\"title\" id='title'\u003eTitle\u003c/p\u003e \u003c!-- here goes the rest of the page --\u003e \u003c/body\u003e 数学公式 BookPad支持用MathJax来显示LaTeX格式的数学公式。你在 这里 可以找到更多的信息。比如: 满足 $\\Gamma(n) = (n-1)!\\quad\\forall n\\in\\mathbb N$ 的伽马方程需要通过积分求解: $$ \\Gamma(z) = \\int_0^\\infty t^{z-1}e^{-t}dt,. $$ 时序图 张三-\u003e李四: 你好啊,张三 Note right of 李四: 呵呵 李四--\u003e张三: 挺好的,你呢? 流程图 st=\u003estart: 开始 e=\u003eend: 结束 op=\u003eoperation: 我的操作 cond=\u003econdition: 是 或 否? st-\u003eop-\u003econd cond(yes)-\u003ee cond(no)-\u003eop 支持Mermaid图 使用mermaid画UML类图 classDiagram Class01 \u003c|-- AveryLongClass : Cool Class03 *-- Class04 Class05 o-- Class06 Class07 .. Class08 Class09 --\u003e C2 : Where am i? Class09 --* C3 Class09 --|\u003e Class07 Class07 : equals() Class07 : Object[] elementData Class01 : size() Class01 : int chimp Class01 : int gorilla Class08 \u003c--\u003e C2: Cool label 使用mermaid画饼图 pie title What Voldemort doesn't have? \"FRIENDS\" : 2 \"FAMILY\" : 3 \"NOSE\" : 45 使用mermaid画甘特图 gantt dateFormat YYYY-MM-DD title 我的甘特图 section A section Completed task :done, des1, 2014-01-06,2014-01-08 Active task :active, des2, 2014-01-09, 3d Future task : des3, after des2, 5d Future task2 : des4, after des3, 5d section Critical tasks Completed task in the critical line :crit, done, 2014-01-06,24h Implement parser and jison :crit, done, after des1, 2d Create tests for parser :crit, active, 3d Future task in critical line :crit, 5d Create tests for renderer :2d Add to mermaid :1d section Documentation Describe gantt syntax :active, a1, after des1, 3d Add gantt diagram to demo page :after a1 , 20h Add another diagram to demo page :doc1, after a1 , 48h section Last section Describe gantt syntax :after doc1, 3d Add gantt diagram to demo page :20h Add another diagram to demo page :48h 使用mermaid画时序图 sequenceDiagram participant Alice participant Bob Alice-\u003e\u003eJohn: Hello John, how are you? loop Healthcheck John-\u003e\u003eJohn: Fight against hypochondria end Note right of John: Rational thoughts\u003cbr/\u003eprevail... John--\u003e\u003eAlice: Great! John-\u003e\u003eBob: How about you? alt is sick Bob-\u003e\u003eJohn: Not so good :( else is well Bob--\u003e\u003eJohn: Jolly good! end 使用mermaid画流程图 graph LR A[Hard edge] --\u003e|Link text| B(Round edge) B --\u003e C{Decision} C --\u003e|One| D[Result one] C --\u003e|Two| E[Result two] 带有格式的mermaid流程图 graph TB sq[Square shape] --\u003e ci((Circle shape)) subgraph A subgraph od\u003eOdd shape]-- Two line\u003cbr/\u003eedge comment --\u003e ro di{Diamond with \u003cbr/\u003e line break} -.-\u003e ro(Rounded\u003cbr\u003esquare\u003cbr\u003eshape) di==\u003ero2(Rounded square shape) end %% Notice that no text in shape are added here instead that is appended further down e --\u003e od3\u003eReally long text with linebreak\u003cbr\u003ein an Odd shape] %% Comments after double percent signs e((Inner / circle\u003cbr\u003eand some odd \u003cbr\u003especial characters)) --\u003e f(,.?!+-*ز) cyr[Cyrillic]--\u003ecyr2((Circle shape Начало)); classDef green fill:#9f6,stroke:#333,stroke-width:2px; classDef orange fill:#f96,stroke:#333,stroke-width:4px; class sq,e green class di orange 注: 你可以在下面的链接中找到更多的内容: 关于 时序图 的语法在这里, 关于 流程图 的语法在这里, 关于 Mermaid 的语法在这里。 嵌入图片 你可以在Markdown文档的任何位置插入一个外部或本地的图片, 还可以像下面所示用{200}指定图片高和宽都为200,或用{200x400}来指定图片高为200,宽为400。如果不指定,图片会以默认大小显示: 脚注 你可以像这样创建一个脚注2. 自动目录 你可以在文档的任何位置使用 [TOC]来插入自动目录,但这个标记需要自己占用单独的一行: [TOC] 特殊符号 © ™ ¡ £ \u0026 \u003c \u003e ¥ € ® ± ¶ § ¦ ¯ « · ¾ × ÷ » ","date":"2022-03-02","objectID":"/bookpadhelp/:3:2","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":"嵌入图标 BookPad支持font awesome图标8,stack icons图标9和Glyphicon图标10和Emoji等多种图标。比如: :fa-asterisk: :st-addthis r5: :fa-address-book: :fa-bath: ;) :pizza: BookPad 是一个简单但又功能全面的Markdown编辑器。 ↩︎ 这里是我的脚注的具体内容,这一行脚注将会被自动放在整个文档的最后。 ↩︎ ","date":"2022-03-02","objectID":"/bookpadhelp/:4:0","tags":["折腾笔记"],"title":"bookpad帮助文件","uri":"/bookpadhelp/"},{"categories":["记录"],"content":" 使用环境: Android 11(氧OS 11.0.5.1) adguard CFA 2.5.4.premium 使用方式: adguard设置为使用CFA代理,并使用CFA本地DNS监听地址 问题 联通网络下出现以下错误 [TCP] dial 🎯 境内 (match IPCIDR/*****) to baidu.com:443 error: ***** connect error: all DNS requests failed, first error: Post \"https://dns.adguard.com/dns-query\": dial tcp4 *****: i/o timeout 修改DNS等各种设置都不能修复 并且更换网络至WIFI或其他运营商时原地复活 解决办法 重新设置一次安卓“私人dns”,改为自动再关闭一次,问题解决 猜测是安卓的doh服务冲突,详细不明 ","date":"2022-03-02","objectID":"/cfa-error/:0:0","tags":["折腾笔记"],"title":"记一次CFA报错份","uri":"/cfa-error/"},{"categories":["记录"],"content":"警告 原文写于2021年3月23日 内容可能已经过时,仅作为原文备份 图片也丢了 本文主要是备忘。关于Pleroma初次安装配置遇到很多的坑,查阅官方文档和issue也有一些过时的信息。 ","date":"2021-03-23","objectID":"/pleroma/:0:0","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"1. 丢了没了懒得改了,总之就是提醒不要用国内的域名商 ","date":"2021-03-23","objectID":"/pleroma/:1:0","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"2.准备服务器 示例环境:debian 10 64位 ","date":"2021-03-23","objectID":"/pleroma/:2:0","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"2.1 为服务器准备SSH key 网上很多教程是使用ssh-keygen生成密钥,这种生成方式是不能直接用于windows的SSH客户端的,如果你的电脑是windows系统,不建议这么做 以windows为例,下载PuTTY 并安装 进入PuTTY安装目录,打开puttygen.exe 点击按钮“Generate”。程序会检测鼠标,需要将鼠标在窗口内不停移动进度条才会进展。 保存公钥及私钥,上传公钥。私钥用于ssh登录,妥善保管私钥。 密码登录SSH后上传,对于一些服务器提供商如vultr,也可以从网站面板上传,不如说更推荐这么做。 vultr上传公钥只需复制图中长长的文本部分到网站面板即可。 -上传完成后设置禁止密码登录SSH nano /etc/ssh/sshd_config 去除注释PasswordAuthentication并修改为no 重启sshd systemctl restart sshd.service ","date":"2021-03-23","objectID":"/pleroma/:2:1","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"2.2 安全设置 安装 fail2ban 以阻止重复登录尝试 apt-get install fail2ban 以下内容来自长毛象官方文档,照抄即可 编辑/etc/fail2ban/jail.local并添加以下内容: [DEFAULT] destemail = your@email.here sendername = Fail2Ban [sshd]`` enabled = true port = 22 [sshd-ddos] enabled = true port = 22 最后重启fail2ban: systemctl restart fail2ban 安装并设置防火墙 长毛象官方文档 中使用的是 iptables-persistent 参考尽量细致的Pleroma搭建教程(仮),建议使用ufw,简单嘛 apt-get install ufw //默认开启出站关闭入站 sudo ufw default allow outcoming sudo ufw default deny incoming //按需开启入站端口 sudo ufw allow 80 sudo ufw allow 443 sudo ufw allow 22 ufw enable ","date":"2021-03-23","objectID":"/pleroma/:2:2","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"2.3 设置域名解析 参考长毛象社区搭建详解第二章即可 ","date":"2021-03-23","objectID":"/pleroma/:2:3","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"3.安装pleroma 其实关于安装方面,pleroma的官方文档已经足够详尽了,一步一步照抄即可,没什么难度。 !以下仅说明OTP版本Pleroma,如过是从source安装,可以尝试参考Pleroma:支持ActivityPub的社交网络服务器 运行到 # Create the database schema su pleroma -s $SHELL -lc “./bin/pleroma_ctl migrate” 这一步时,安装程序会问很多问题,并以此生成配置文件。只要域名没写错就没什么大问题,大部分后期都可以改。 个人建议这个阶段不要开启Pleroma in-database,有一定风险,没有必要现在开,调试好了再说 另外 OTP版安装文档中,编辑nginx config中有这么一句 $EDITOR path-to-nginx-config 初见的话有点摸不着头脑,其实就是去编辑上一步操作的/etc/nginx/pleroma.conf 按文档走完,访问域名就可以看见页面了。 注意,最后一步创建管理员帐户后,终端中会给一段链接,通过浏览器访问这个链接设置密码 ","date":"2021-03-23","objectID":"/pleroma/:3:0","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"4.设置pleroma 设置文件在/etc/pleroma/config.exs 官方文档要求改动这个文件,但是个人建议不要改动,直接备份一份到其他地方去。 使用这份设置文件绝对能打开pleroma,这一点非常重要。万一在Admin-FE输入了错误的设置导致pleroma无法打开,有它在还可以救一命 后续建议都在数据库模式下于Admin-FE操作。 因为官方文档有关设置文件中各项参数的说明并不是很好理解,查阅他人留下的经验又很容易碰到过时的设置参数,导致出现错误却查无可查。而使用Admin-FE就不会遇到这种问题。即使不打算长期使用数据库模式,也只要从数据库导出一份设置文件就好 另外,官方文档中的$ ./bin/pleroma_ctl 都是指进入/opt/pleroma目录后的操作 关于数据库模式下,输出设置中可能存在的bug 感谢@ShyKana@wuppo.allowed.org的帮助。 pleroma版本 2.3.0-1-gb221d77a 实际使用发现,按照官方文档描述导出设置文件 执行$ ./bin/pleroma_ctl config migrate_from_db会出现错误,运行无效。 根据@ShyKana@wuppo.allowed.org的建议 可以尝试修改/etc/systemd/system/pleroma.service 找到ProtectSystem=full,改为ProtectSystem=true 重新启动pleroma systemctl daemon-reload systemctl restart pleroma 重新执行导出 $ ./bin/pleroma_ctl config migrate_from_db 可以发现/etc/pleroma目录下输出了文件 prod.exported_from_db.secret.exs :fa-cog spin: 随后需要移走这个文件,目录下存在该文件会导致pleroma无法启动。 另外需要注意的是,只有在数据库模式下才可以导出设置文件,只有在设置文件模式下才可以导入数据库,导出的文件不可直接用于启动pleroma,请与config.exs合并之后再使用。 报错请先检查一下目前运行的模式。 检查方式即查找下文提到的config :pleroma, configurable_from_database 备份好了就可以开始了 ","date":"2021-03-23","objectID":"/pleroma/:4:0","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"4.1 修改pleroma为数据库模式 Admin-FE的大部分功能仅在数据库模式下有效。 修改/etc/pleroma/config.exs 在最底下找到config :pleroma, configurable_from_database 将其改为true,重启pleroma systemctl restart pleroma ","date":"2021-03-23","objectID":"/pleroma/:4:1","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"4.2 进入Admin-FE设置 浏览器进入 https://你的域名/pleroma/admin/ 登录管理员帐户,即可看到设置界面。 大部分内容都是按需设置即可,可以省略大量查阅文档,磨配置文件的过程。 如果不是很清楚的话,建议修改配置前使用vps的snapshots功能备份服务器,玩坏了也不用担心,整个恢复服务器就好。 比如vultr就提供免费的snapshots,如果有这项功能的话务必用起来,一步操作一备份都没关系,这不是胆小,是安全至上( 开启了Media proxy后不显示缩略图的话,可以尝试开启Media preview proxy ","date":"2021-03-23","objectID":"/pleroma/:4:2","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"4.3 部署媒体文件外置存储 这是一个难点,官方文档和官方gitlab中的issues中确实有相关内容,但是不是过于老旧就是说明不清,特别是关于使用AWS以外的兼容S3存储该如何设置。 当然,如果你的服务器没有存储方面的担忧,就可以跳过 关于如何选择外置存储方面可以参考长毛象社区搭建详解第六章 这里以Scaleway为例 注册并创建一个Bucket,存储桶大小设置成75G就可以白嫖,岂不美哉( 长毛象社区搭建详解第六章 要求储存桶的名称务必填写媒体服务的子域名。理论上来说并不是必须这么做,但是照做,避免不必要的坑。 Visibility设置为 Private。网络上有些教程要求设置为Public,但是实际上并不需要设置为 Public,否则任何人都可以看到媒体文件列表。 获取所需的信息 这里就照搬 长毛象社区搭建详解 了 注意这里的api key只会显示一次,请立即记录下来 接下来在Admin-FE中填写信息。 这是我的设置,直接套模板就行,media.shiina-rimo.cafe换成自己的域名,即之前填写的媒体服务的子域名 另外填上上一步获得的api key就好 官方文档的描述很难懂,特别是对于Truncated namespace的作用的说明模棱两可。但是Admin-FE上的描述就很合适。 Bucket namespace的内容,即文件上传到存储桶的目录。如填写media,文件上传到/media/ 我是空着的,即直接上传到根目录。 接下来通过终端重启pleroma: systemctl restart pleroma ","date":"2021-03-23","objectID":"/pleroma/:4:3","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"4.4 设置DNS重定向 在cloudflare中添加一个DNS条目 类型CNAME,名称即之前填写的媒体服务的子域名。目标指向Bucket Endpoint,可在scaleway存储桶页面Bucket Settings选项卡查询。 回到pleroma,试着传一个图片文件,并发出嘟文,看看是否正常 如果有问题,可以试试删除Media proxy的Base URL看看是否恢复 一切正常,就大功告成! 补充:如需邮件功能,建议参考 技术小白如何搭建Mastodon实例 中的 邮件服务 章节设置邮箱,然后去Admin-FE的mailer中填写Pleroma.Emails.Mailer部分,Adapter选择STMP。 ","date":"2021-03-23","objectID":"/pleroma/:4:4","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"},{"categories":["记录"],"content":"5.备份pleroma pleroma需要备份的内容主要是数据库、设置文件、静态目录。 官方文档提到的config/setup_db.psql,目前OTP版本似乎不存在 备份数据库 参考官方文档: sudo -Hu postgres pg_dump -d \u003cpleroma_db\u003e –format=custom -f \u003c/path/to/backup_location/pleroma.pgdump\u003e 上述命令中,“postgres”是PostgreSQL 默认管理员用户名,没有自行修改则不需改动 \u003cpleroma_db\u003epleroma的数据库名。 \u003c/path/to/backup_location/pleroma.pgdump\u003e填写备份文件输出目录 数据库名默认pleroma,不知道的话可以按照以下方法查看: 切换到数据库 sudo -u postgres psql 查看所有用户 \\du 查看所有数据库 \\l 默认的数据库应该是pleroma 退出 \\q 完整的postgresql常用命令可以看这里 复制输出文件pleroma.pgdump 复制目录及所有文件/etc/pleroma/,这里是设置文件存放目录 复制目录及所有文件/var/lib/pleroma/,这里是使用过程中上传文件、表情包等默认存放位置 (可选)复制/etc/nginx/sites-available/pleroma.conf 因为除了Pleroma外操作很少,备份和恢复操作我大多是继续使用VPS的Snapshots功能 所以恢复方面未实际操作过,就不写了,链接官方文档 ","date":"2021-03-23","objectID":"/pleroma/:5:0","tags":["折腾笔记"],"title":"Pleroma的安装、初步设置、数据备份","uri":"/pleroma/"}]